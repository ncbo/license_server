- @title = "Licence Detail"
%h1 Licence Detail
%table.detail
  - if current_user_admin?
    %tr
      %th License ID:
      %td.top= @license.id
  %tr
    %th Created On:
    %td.top= @license.created_at
  %tr
    %th Appliance ID:
    %td.top= @license.appliance_id
  %tr
    %th Name:
    %td.top= "#{@license.first_name} #{@license.last_name}"
  %tr
    %th Organization:
    %td.top= @license.organization
  %tr
    %th Project Purpose:
    %td.top= @license.license_purpose.name
  %tr
    %th Approval Status:
    %td.top
      - if !current_user_admin? && @license.approval_status === License.approval_statuses[:disapproved]
        :plain
            Please email us at <a href='mailto:#{$SUPPORT_EMAIL}'>#{$SUPPORT_EMAIL}</a> for further instructions on getting your license key.
      - else
        = @license.approval_status.humanize
        - if @license.expired?
          %span.error-msg (Expired)
  %tr
    %th Project Information:
    %td.top= @license.project_info
  %tr
    %th Reason for Needing Appliance:
    %td.top= @license.reason
  %tr
    %th License Key:
    %td.top
      - if @license.license_key
        %span#license-key= @license.license_key
        %button#copy-button{class: "btn btn-sm btn-primary", title: "Copy the license key to the clipboard.", alt:  "Copy the license key to the clipboard."}
          %img{:src => "data:image/svg+xml;utf8;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTkuMS4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0iQ2FwYV8xIiB4PSIwcHgiIHk9IjBweCIgdmlld0JveD0iMCAwIDQ4OC4zIDQ4OC4zIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA0ODguMyA0ODguMzsiIHhtbDpzcGFjZT0icHJlc2VydmUiIHdpZHRoPSIxNnB4IiBoZWlnaHQ9IjE2cHgiPgo8Zz4KCTxnPgoJCTxwYXRoIGQ9Ik0zMTQuMjUsODUuNGgtMjI3Yy0yMS4zLDAtMzguNiwxNy4zLTM4LjYsMzguNnYzMjUuN2MwLDIxLjMsMTcuMywzOC42LDM4LjYsMzguNmgyMjdjMjEuMywwLDM4LjYtMTcuMywzOC42LTM4LjZWMTI0ICAgIEMzNTIuNzUsMTAyLjcsMzM1LjQ1LDg1LjQsMzE0LjI1LDg1LjR6IE0zMjUuNzUsNDQ5LjZjMCw2LjQtNS4yLDExLjYtMTEuNiwxMS42aC0yMjdjLTYuNCwwLTExLjYtNS4yLTExLjYtMTEuNlYxMjQgICAgYzAtNi40LDUuMi0xMS42LDExLjYtMTEuNmgyMjdjNi40LDAsMTEuNiw1LjIsMTEuNiwxMS42VjQ0OS42eiIgZmlsbD0iI0ZGRkZGRiIvPgoJCTxwYXRoIGQ9Ik00MDEuMDUsMGgtMjI3Yy0yMS4zLDAtMzguNiwxNy4zLTM4LjYsMzguNmMwLDcuNSw2LDEzLjUsMTMuNSwxMy41czEzLjUtNiwxMy41LTEzLjVjMC02LjQsNS4yLTExLjYsMTEuNi0xMS42aDIyNyAgICBjNi40LDAsMTEuNiw1LjIsMTEuNiwxMS42djMyNS43YzAsNi40LTUuMiwxMS42LTExLjYsMTEuNmMtNy41LDAtMTMuNSw2LTEzLjUsMTMuNXM2LDEzLjUsMTMuNSwxMy41YzIxLjMsMCwzOC42LTE3LjMsMzguNi0zOC42ICAgIFYzOC42QzQzOS42NSwxNy4zLDQyMi4zNSwwLDQwMS4wNSwweiIgZmlsbD0iI0ZGRkZGRiIvPgoJPC9nPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+Cjwvc3ZnPgo="}
          %span#copy-button-text Copy
      - else
        Not Generated
  %tr
    %th Expires After:
    %td.top= @license.valid_date
  - if current_user_admin?
    %tr
      %th Identification:
      %td.top= @license.identification
    %tr
      %th Admin Comments:
      %td.top= @license.comments

    %tr
      %td
      %td
        %span{style: "float:left;margin-right:20px;"}
          = button_to "  Approve   ", approve_license_path(@license.id), method: :post, class: "button button-green", data: { confirm: "Are you sure you want to approve the license with ID: #{@license.id}, generate the licence key and notify the user?" }
        %span
          = button_to "Disapprove ", disapprove_license_path(@license.id), method: :post, class: "button button-red", data: { confirm: "Are you sure you want to disapprove the license with ID: #{@license.id}?" }
%br
= link_to 'Back to Licenses', :back
